DROP TABLE IF EXISTS PRECIOS;
DROP TABLE IF EXISTS PRODUCTOS;
DROP TABLE IF EXISTS OFERTAS;
DROP TABLE IF EXISTS BRANDS;
DROP TABLE IF EXISTS LISTA_PRECIOS;



CREATE TABLE IF NOT EXISTS PRODUCTOS (
ID_PRODUCTO IDENTITY NOT NULL PRIMARY KEY, 
DESCRIPCION VARCHAR(255) NOT NULL);

INSERT INTO PRODUCTOS VALUES(1, 'Camisa Verde');
INSERT INTO PRODUCTOS VALUES(35455, 'Camisa Azul');
INSERT INTO PRODUCTOS VALUES(35456, 'Camisa Negra');


CREATE TABLE IF NOT EXISTS OFERTAS (
ID_OFERTA IDENTITY NOT NULL PRIMARY KEY, 
DESCRIPCION_OFERTA VARCHAR(255) NOT NULL,
FECHA_START TIMESTAMP NOT NULL,
FECHA_END TIMESTAMP NOT NULL,
PRIORITY INT UNIQUE);

INSERT INTO OFERTAS VALUES(1, 'Primavera', '2020-06-14T00:00:00', '2020-12-31T23:59:59',1);
INSERT INTO OFERTAS VALUES(2, 'Verano', '2020-06-14T15:00:00', '2020-06-14T18:30:00',2);
INSERT INTO OFERTAS VALUES(3, 'Otono', '2020-06-15T00:00:00', '2020-06-15T11:00:00',3);
INSERT INTO OFERTAS VALUES(4, 'Invierno', '2020-06-15T16:00:00', '2020-12-31T23:59:59',4);
	

CREATE TABLE IF NOT EXISTS BRANDS (
ID_BRAND IDENTITY NOT NULL PRIMARY KEY, 
DESCRIPCION_BRAND VARCHAR(255) NOT NULL);

INSERT INTO BRANDS VALUES(1, 'ZARA');
INSERT INTO BRANDS VALUES(2, 'PULL AND BEAR');


CREATE TABLE IF NOT EXISTS LISTA_PRECIOS (
ID_LISTA_PRECIO IDENTITY NOT NULL PRIMARY KEY, 
DESCRIPCION_LISTA_PRECIO VARCHAR(255) NOT NULL);

INSERT INTO LISTA_PRECIOS VALUES(1, 'Listado Clientes Preferentes');
INSERT INTO LISTA_PRECIOS VALUES(2, 'Listado Clientes No Habituales');


CREATE TABLE IF NOT EXISTS PRECIOS (
ID IDENTITY NOT NULL PRIMARY KEY,
ID_PRODUCTO INT NOT NULL,
ID_OFERTA INT NOT NULL,
ID_BRAND INT NOT NULL,
ID_LISTA_PRECIO INT NOT NULL,
PRECIOS DOUBLE NOT NULL,
CURR VARCHAR(255) NOT NULL,
CONSTRAINT FK_PRECIOS_PRODUCTOS FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTOS (ID_PRODUCTO),
CONSTRAINT FK_PRECIOS_OFERTAS FOREIGN KEY (ID_OFERTA) REFERENCES OFERTAS (ID_OFERTA),
CONSTRAINT FK_PRECIOS_BRANDS FOREIGN KEY (ID_BRAND) REFERENCES BRANDS (ID_BRAND),
CONSTRAINT FK_PRECIOS_LISTA_PRECIOS FOREIGN KEY (ID_LISTA_PRECIO) REFERENCES LISTA_PRECIOS (ID_LISTA_PRECIO),
CONSTRAINT UK_PRODUCTO_OFERTA_BRAND_LISTAPRECIO UNIQUE (ID_PRODUCTO, ID_OFERTA, ID_BRAND, ID_LISTA_PRECIO)
);

INSERT INTO PRECIOS VALUES(1,1,1,1,1,67.21,'EUR');
INSERT INTO PRECIOS VALUES(2,35455,1,1,1,35.50,'EUR');
INSERT INTO PRECIOS VALUES(3,35455,2,1,1,25.45,'EUR');
INSERT INTO PRECIOS VALUES(4,35455,3,1,1,30.50,'EUR');
INSERT INTO PRECIOS VALUES(5,35455,4,1,1,38.95,'EUR');
INSERT INTO PRECIOS VALUES(6,35455,1,2,2,67.21,'EUR');
INSERT INTO PRECIOS VALUES(7,35455,2,2,2,67.21,'EUR');





